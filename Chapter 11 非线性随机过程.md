# **Chapter 11 非线性随机过程**

## **鞅，随机游走和非线性**

11.1在10.2中，区分了序列不相关和独立。尽管这种区别是GARCH模型的核心，它也具有更普遍的重要性，体现在“鞅”的概念，随机过程是“公平竞争”的数学模型，一个鞅可被定义为一个有以下属性的随机过程$x_t$：

1. 对每个t，$E(|x_t|)<\infty$；

2. $E(x_t|x_s,x_{s-1},...)=x_s$。

写为

$E(x_t-x_s|x_s,x_{s-1},...)=0,s<t$（11.1）

鞅属性意味着对未来鞅增量的MMSE预测为零。该属性可以推广到各种情况：

$E(x_t-x_s|x_s,x_{s-1},...)\ge0,s<t$

其中我们有一个下鞅，不等号反转，则给我们上鞅。



11.2 （11.1）给出的鞅可以等效地写为：

$x_t=x_{t-1}+a_t$

其中$a_t$被称为鞅增量或鞅差分。以这种形式写时，$x_t$看起来与随机游走相同，其中$a_t$定义为从固定分布中得出的一个平稳且不相关的序列，即白噪声（参见4.6）。

可以使用其他定义。例如，$a_t$可能定义为严格的白噪声，因此它既是平稳的又是独立的序列，而不只是不相关。而且，$a_t$可能是不相关的，但不一定是平稳的。而白噪声假设排除了这种情况，鞅差分允许这种行为。这意味着更高的条件矩之间，特别的，随时间变化的条件方差之间可能有依赖。



11.3这种依赖形式的可能性自然导致考虑非线性随机过程能够建模该行为。但是，非线性可以通过多种方式引入，其中一些可能会违反鞅模型。作为说明，假设$x_t$由过程$\triangledown x_t=\eta_t$产生，$\eta_t$定义为：

$\eta_t=a_t+\beta a_{t-1}a_{t-2}$

$a_t$是严格白噪声。$\eta_t$有零均值，常数方差，以及自相关函数：

$E(\eta_t \eta_{t-k})=E(a_ta_{t-k}+\beta a_{t-1}a_{t-2}a_{t-k}+\beta a_ta_{t-k-1}a_{t-k-2}+\beta^2a_{t-1}a_{t-2}a_{t-k-1}a_{t-k-2})$

对于所有$k\ne0$，此表达式中的每一项均具有零期望，因此，只要考虑它的二阶性质而言，$\eta_t$的行为就像一个独立过程。但是，对未来观测$\eta_{t+1}$的MMSE预测，不为零（无条件期望），但条件期望：

$\hat\eta_{t+1}=E(\eta_{t+1}|\eta_t,\eta_{t-1},...)=\beta a_ta_{t-1}$

因此，$x_t$不是鞅，因为：

$E(x_{t+1}-x_t|\eta_t,\eta_{t-1},...)=\hat\eta_{t+1}\ne0$

$\eta_t$过程的非线性结构可以用于改善$x_t$的预测，比起鞅模型简单的“无变化”预测。



11.4 使用3.30‑3.32的结果，如果$w_t=\triangledown x_t$是严格的白噪声，则样本自相关的渐近分布（通过$\sqrt{T}$标准化）根据$w_t$的实现计算的结果将为N（0，1），因此如果$\sqrt{T}|r_1|>1.96$,随机游走原假设将以5％的显著水平被拒绝。

如果考虑一组样本自相关，$r_1,...,r_k$，则即使零假设为真，有些也可能显著：平均而言1/20将在5％的水平上显著。如3.32所述，在这些情况下，可以使用（3.13）portmanteau统计量Q（K）。在随机游走零假设下，这个统计量是$\chi_K^2$分布，因此零假设将以获得足够高的值被拒绝。注意，此检验不需要特定的备择假设：因此，它可以被视为“诊断”检验，有希望对于广范围的备择假设，有反对原假设的效力。



11.5然而，portmanteau检验确实要求随机游走的新息为严格白噪声。如果新息仅仅不相关，而不是独立的，则此检验过程将不可靠。为了说明这一点，可以将对$w_t$的严格白噪声假设放宽到仅仅满足弱依赖条件。$\sqrt{T}r_1\sim N(0,\tau^2)$，其中：

$\tau^2=\sigma_w^{-4}(V(w_1w_2)+2\sum_{i=1}^{\infty}Cov(w_1w_2,w_{i+1}w_{i+2}))$

Romano和Thombs提供的结果（1996年，定理2.1）。一个这样过程的例子是$w_t=z_tz_{t-1}$，其中$z_t$本身是零均值严格白噪声，$E(z_t^2=\sigma_z^2,E(z_t^4)<\infty)$。在这种情况下，Romano和Thombs表示，对所有i\>0，

$Cov(w_1w_2,w_{i+1}w_{i+2})=0$

$V(w_1w_2)=E(w_1^2w_2^2)=(E(z_0^2))^2E(z_1^4)=\sigma_z^4E(z_1^4)$

和

$\sigma_w^2=E(w_t^2)=E(z_t^2z_{t-1}^2)=\sigma_z^4$

从而，

$\tau^2=\frac{4E(z_1^4)}{\sigma_z^4}>1$

例如，如果$z_t$是标准正态，$\tau^2=3$，并且在一般情况下，$\tau^2$可以变得任意大。因此，基于$\sqrt{T}|r_1|>1.96$的零相关性检验，将导致错误拒绝零相关性的假设可能性很高。



11.6 Romano和Thombs（1996，例3.5）也表明，如果$w_t$不是严格白噪声，则Q（K）不再渐近分布为$\chi_K^2$。例如，如果$w_t=z_tz_{t-1}$，则Q（K）分布为独立$\chi_1^2$变量的带权重的和，导致拒绝概率大于使用$\chi_K^2$的名义显著水平。

因此，Lobarto等（2001，2002）建议修改portmanteau统计量为：

$\widetilde Q(K)=T\sum_{i=1}^K(\frac{r_i^2}{v_i})\stackrel{a}{\sim}\chi_K^2$

其中

$v_i=T^{-1}\sum_{t=i+1}^T\frac{(w_t-\bar w_t)^2(w_{t-i}-\bar w_t)^2}{\hat \sigma_w^4}$



## **非线性随机模型**

11.7如3.6所述，Wold的分解定理使我们可以把每一个弱平稳的，纯粹不确定的随机过程，视为不相关的随机变量序列的线性组合。随机过程可以认为是非线性的，如果不满足分解的假设，例如，如果表示为：

$x_t-\mu=f(a_t,a_{t-1},a_{t-2},...)$(11.2)

其中$f(\cdot)$是任意非线性函数。但是，“维数灾难”意味着这种表示几乎没有实际用途。因此，作为$f(\cdot)$的近似值，考虑（11.2）在零附近的泰勒展开式：

$x_t-\mu=f(0,a_{t-1},a_{t-2})+a_tf^{'}(0,a_{t-1},a_{t-2})+0.5a_t^2f^{''}(0,a_{t-1}+...$

其中$f^{'}$和$f^{''}$是f关于$a_t$的一阶和二阶导数。通过降低高阶项，我们可以按照条件矩表示$x_t$。例如，通过仅保留前两项，$x_t$可以分别表示为条件均值和方差的函数。也可以通过假设一些$f(\cdot)$的低阶多项式函数来获得非线性的简单形式。例如，一阶非线性移动平均（参见Robinson，1977年）。

$x_t=a_t+\psi_1a_{t-1}^2$

也可以使用$x_t$滞后的多项式函数（Jones，1978），而引入非线性的另一种简单方法是允许$x_t$通过不同方式响应取决于其符号的新息。例如，Wecker（1981）引入了非对称滑动平均过程，其过程一阶形式为：

$x_t=a_t+\theta a_{t-1}+\psi\mathbf 1(a_{t-1}>0)a_{t-1}$



## **双线性模型**

11.9 非线性模型的重要一类是双线性模型，它采用一般形式

$\phi(B)(x_t-\mu)=\theta(B)\varepsilon_t+\sum_{i=1}^R\sum_{j=1}^S\gamma_{ij}x_{t-i}\varepsilon_{t-j}$(11.3)

这里$\varepsilon_t\sim SWN(0,\sigma_{\varepsilon}^2)$，该符号用于表示新息$\varepsilon_t$是严格白噪声。（11.3）右边第二项是$\varepsilon_{t-j}$和$x_{t-i}$的双线性形式，解释该模型的非线性特征，如果所有$\gamma_{ij}$是零，（11.3）明显地降低到熟悉的ARMA模型。双线性模型可以认为是未知非线性函数$f(\cdot)$的更高阶泰勒泰勒逼近，相比Wold分解。



11.10 对于这种一般的双线性形式，很少进行分析，但是Granger和Andersen（1978）分析了几种简单双线性形式的属性，特征为：

$x_t=\varepsilon_t+\gamma_{ij}x_{t-i}\varepsilon_{t-j}$

如果i\>j该模型称为上对角线，如果i=j是对角线，并且如果i\<j，是下对角线。如果我们定义$\lambda=\gamma_{ij}\sigma$那么，对于上对角线模型，$x_t$具有零均值和方差$\sigma_{\varepsilon}/(1-\lambda^2)$，因此$|\lambda|<1$是平稳的必要条件。

使用$x_t$的SACF的常规识别技术将该序列识别为白噪声，但是Granger和Andersen证明，至少从理论上讲，$x_t$的平方的SACF可以识别$x_t^2$为ARMA（i，j）过程，因此通过分析$x_t^2$,我们可以区分白噪声和这种双线性模型。

如果$|\lambda|<1$，对角线模型也将是平稳的。如果i=j=1，$x_t$将被识别为MA（1），$0<\rho_1<0.1547$（对应于$\lambda=\pm0.605$），而$x_t^2$将被标识为ARMA（1,1）。但是，如果实际上$x_t$是MA（1），则$x_t^2$也将是MA(1)，因此该结果允许双线性模型有别于线性模型。通常，对角线模型的水平将被标识为MA（i） 。下对角线模型基本上就像上对角线模型，因为它们似乎是白噪声，但通常$x_t^2$遵循ARMA（i，j）过程。



## **阈值和平滑过渡自回归**

11.18一类流行的非线性模型是自激励阈值自回归（SETAR）过程，它通过定义一个分段自回归模型的集合，其开关点或“阈值”通常是未知的（参见Tong和Lim，1980；Tong，1990；Teräsvirta，2006）：

$x_t=\sum_{j=1}^r(\phi_{j,1}x_{t-1}+...+\phi_{j,p}x_{t-p}+a_{j,t})\mathbf1(c_{j-1}<x_{t-d}\le c_j)$(11.7)

这里d是（整数）延迟参数，$c_1<c_2<...<c_{r-1}$是阈值：模型通常表示为SETAR（r，p，d）。假设$a_{j,t}\sim WN(0,\sigma_j^2),j=1,...,r$，以便允许误差方差跨r“制度”进行变更。流行版本的（11.7）是两体制SETAR（2：p，d）模型：

$x_t=(\phi_{1,1}x_{t-1}+...+\phi_{1,p}x_{t-p}+a_{1,t})\mathbf1(x_{t-d}\le c_1)+(\phi_{2,1}x_{t-1}+...+\phi_{2,p}x_{t-p}+a_{2,t})(1-\mathbf1(x_{t-d}\le c_1))$

SETAR模型的一个重要特征是其产生“限制周期”的能力：如果推断（11.7）假设误差项等于零，则推测序列显示给定长度不会消失的振动。

如前所述，不对称性可能会被以下制度捕获：例如，如果$x_{t-d}$测量经济商业周期的相位，则两体制SETAR可以描述扩张和衰退的动态特性不同的过程。如果过渡变量$x_{t-d}$通过其差分$\triangledown x_{t-d}$替换，则任何不对称性都在于序列增长率，例如，增长率可能很快，但恢复到较低的增长水平可能很慢。

如果将过渡变量$x_{t-d}$替换为t，则模型将变为自回归，在时间$c_1,...,c_{r-1}$有r-1个中断。



11.19 SETAR的提法要求从一种制度过渡到另一个是即时的。允许变速平滑是通过定义指数自回归（EAR）过程：

$x_t=\phi_1x_{t-1}+...+\phi_px_{t-p}+G(\gamma,x_{t-d})(\varphi_1x_{t-1}+...+\varphi_px_{t-p}+a_t)$(11.8)

其中过渡函数为

$G(\gamma,x_{t-d})=exp(-\gamma x_{t-d}),\gamma>0$

围绕零对称，在0处取值为1，且随着$|x_{t-d}|\to\infty$,$G(\gamma,x_{t-d})\to0$。从(11.8)，EAR可以解释为具有随机的时变系数$\phi_i+G(\gamma,x_{t-d})\varphi_i$的线性AR过程。当$\gamma\to0$或者$\gamma\to\infty$时获得“纯”线性。这个模型，原来由Haggan和Ozaki（1981）提出，随后Teräsvirta（1994）进行了扩展，允许转移函数的不对称性，通过包括位置参数c：

$G_E(\gamma,c,x_{t-d})=exp(-\gamma (x_{t-d}-c)^2),\gamma>0$(11.9)

这就是所谓的指数平滑过渡AR[ESTAR（p，d）]模型，而转换函数的替代规范产生logistic STAR（LSTAR）模型：

$G_L(\gamma,c,x_{t-d})=(1+exp(-\gamma (x_{t-d}-c)))^{-1},\gamma>0$(11.10)

注意，当$\gamma=0$时，;（11.8）减为线性AR模型，而如果$\gamma\to\infty$，LSTAR模型接近SETAR，尽管有$\sigma_1=\sigma_2$。如果在（11.9）中t替换$x_{t-d}$，则所得模型称为时变自回归，可以检验线性AR模型中参数不变性零假设，且平滑变化参数为备择假设：参见Lin和Teräsvirta（1994）。



## **马尔可夫转换模型**

11.21 引入不对称的另一种方法是考虑“制度转换”模型。Hamilton（1989，1990），Engle，Hamilton和Lam（1990）都提出了转换体制马尔可夫模型的变体，这可以看作是ARMA过程的非线性扩展，可以适应复杂的动力学，例如不对称和条件异方差。设置是8.1的UC模型，即等式（8.1），其中$z_t$现在演变为两态马尔可夫过程：

$z_t=\alpha_0+\alpha_1S_t$(11.1)

其中

$P(S_t=1|S_{t-1}=1)=p$

$P(S_t=0|S_{t-1}=1)=1-p$

$P(S_t=1|S_{t-1}=0)=q$

$P(S_t=0|S_{t-1}=0)=1-q$

噪声分量$u_t$假定遵循AR（r）过程$\phi(B)u_t=\varepsilon_t$，其中，所述新息序列$\varepsilon_t$是严格白噪声但$\phi(B)$可能包含一个单位根，因此与传统的UC规范不同，$u_t$可能不平稳。实际上，当p=1-q，常规UC模型的一种特殊情况。随机游走分量具有仅限于两点随机变量的新息，取值为0和1分别具有概率q和1-q，而不是从连续分布（例如正态分布）中得出的零均值随机变量。



11.22 $S_t$的随机过程是严格平稳的，具有AR（1）表示：

$S_t=(1-q)+\lambda S_{t-1}+V_t$

其中λ=p+q-1,新息$V_t$具有条件概率分布

$P(V_t=(1-p)|S_{t-1}=1)=p$

$P(V_t=-p|S_{t-1}=1)=1-p$

$P(V_t=-(1-q)|S_{t-1}=0)=q$

$P(V_t=q|S_{t-1}=0)=1-q$

该新息与$S_t$的滞后值无关，既然

$E(V_r|S_{t-j}=1)=E(V_r|S_{t-j}=0)=0,j\ge1$

但它并不独立于此滞后值，例如，

$E(V_t^2|S_{t-1}=1)=p(1-p)$

$E(V_t^2|S_{t-1}=0)=q(1-q)$

马尔可夫过程的方差可以证明是

$\alpha_1^2\frac{(1-p)(1-q)}{(2-p-q)^2}$

当该方差接近零时，即p和q趋近于1时，随机游走分量(11.11)趋于确定性趋势。如果$\phi(B)$没有单位根，$x_t$将接近趋势平稳过程，而如果$\phi(B)$确实包含单位根，$x_t$接近差分平稳过程。



11.23 通过使用（11.11）写噪声分量为下式，可以获得模型的 ML估计

$u_t=x_t-\alpha_0-\alpha_1S_t$(11.12)

使用(11.12)，新息$\varepsilon_t=\phi(B)u_t$可以被表示为

$\varepsilon_t=\phi(B)(x_t-\alpha_0-\alpha_1S_t)$

假设新息是正态的，则该表达式可用于计算对数似然函数，注意它可以分解作为条件（根据过去的观察）对数似然的总和。这些条件对数可能性取决于未观察到的当前和过去马尔可夫状态的实现。递归关系可以显示为保持在状态的条件分布和观测的条件似然之间，可以利用它来获得评估对数似然函数的算法。关于未观察到的分量和状态获得的推论，作为评估副产物。



## **神经网络**

11.24神经网络（NNs）指一类广泛的非参数模型，近年来广受欢迎，涵盖众多学科，包括计算机科学，心理学，生物学，语言学和模式识别（参见Haykin，1999年）。这些模型源自于模仿人脑结构和行为的认知科学。

NN的最常见类型之一是多层感知器（MLP），可用于非参数回归和分类。这些模型分为三个基本层：自变量的输入层，因变量的输出层以及一个或更多的位于中间的隐藏层。激活函数调节每层元素之间的依赖性。具有单个隐藏层的单变量自回归MLP模型可以表示为：

$x_t=\sum_{i=1}^p\phi_ix_{t-i}+\sum_{j=1}^q\beta_jG(\sum_{i=1}^p\varphi_ix_{t-i})+\varepsilon_t$(11.13)

$G(\cdot)$是激活函数，是有界的非线性函数，与转换函数用于STAR模型有相同方式。在实践中采用了几种激活函数，最常见的是双曲正切和logistic。(11.13)中第二项是指MLP中的隐藏层。显然，当激活函数为线性时，（11.13）将折叠为标准AR（p）模型。残差项$\varepsilon_t$通常假定为白噪声随机变量。



11.25 NNs的高灵活性，丰富的参数化和非线性特性使估计特别困难（参见White，2006年）。主要问题之一是神经网络非常容易过拟合。因此，神经网络的估计策略与传统的线性模型估计不同，通常包括两个步骤：样本内优化（训练或学习）和循环测试（交叉验证），以及样品外测试。样本内优化通常会在达到最佳性能之前终止，当交叉验证样本中的模型性能开始恶化时。这样可以避免过度拟合，且更有可能提供测试样本良好的预测。估计（训练）使用的算法变化很大，通常涉及调整某些误差准则（例如均方误差或绝对误差）的负梯度的方向。



11.26 已经提出了几种迭代方法来求解（11.13）固有的非线性估计，并且通常将它们与其他约束条件组合在一起以确保函数估计的平滑度。对于MLP，大多数这些方法都是基于反向传播算法的变体，它从输出层倒向工作，并使用渐变规则来迭代地更改偏差和权重。该算法对误差空间中的局部极小值敏感，因此，以不同的起始值应用几次。

MLP估计中的另一个陷阱涉及选择合适的模型架构：隐藏层数和每层元素的数量。可以从一个小模型开始，然后添加隐藏层，直到性能达到最佳，或者从超大型模型开始并删除小权重以减小其尺寸。有时是初步进行优化以选择一组良好的起始值和模型架构来减轻计算负担。模型性能通常根据信息标准进行评估。



11.27 MLP的主要问题是它们的“黑匣子”属性，因为模型的参数和结构几乎没有直觉和结论，只能通过模拟或敏感性分析隐式地绘制。此外，参数的显著性存在问题。



## **检验非线性**

11.36 由于偏离线性的形式通常很难指定先验条件，许多非线性检验本质上都是诊断性的，即没有指定线性原假设的明确备择假设。这个，当然，导致难以区分这样的检验可能发现的任何“非线性设定错误”可能的原因。



11.37非线性的检测由于以下事实而变得更加复杂，它具有与其他类型的时间序列行为类似的症状。例如，安德森（Andersson）等人（1999）表明，长记忆可能会导致虚假拒绝线性假设。正如格兰杰和Teräsvirta（1999），Diebold和Inoue（2001）表明的，相反也有可能，因为某些非线性过程，显示出可能证明通过长记忆模型进行建模合理性的特征。



11.40基于Volterra的扩展，Ramsey（1969），Keenan（1985）和Tsay（1986b）提供了回归类型的检验线性反对未指定的备择假设。这些似乎有反对非线性滑动平均和双线性备择假设的很好的功效，但反对ARCH模型的功效可能较低。在开发这些检验时，我们假设AR（p）过程已经拟合到观测序列$x_t$，残差$e_t$和拟合值$\hat x_t=x_t-e_t$，已经计算。



11.41 Ramsey原始的回归误差设定检验（RESET）由辅助回归构造

$e_t=\sum_{i=1}^p\varphi_ix_{t-i}+\sum_{j=2}^h\delta_j\hat x_t^j+v_t$

是假设$H_0:\delta_j=0,j=2,...,h$的F检验。如果h=2，相当于Keenan检验，而Tsay增强了具有二阶项的辅助回归：

$e_t=\sum_{i=1}^p\varphi_ix_{t-i}+\sum_{i=1}^p\sum_{j=i}^p\delta_{ij}x_{t-i}x_{t-j}+v$

其中线性假设是$H_0:\delta_{ij}=0$，对所有i，j。这些检验有LM解释，而Tsay检验具有比RESET更大的反对多种非线性模型的效力。Teräsvirta等（1993）提供了进一步的扩展，其中辅助回归变为：

$e_t=\sum_{i=1}^p\varphi_ix_{t-i}+\sum_{i=1}^p\sum_{j=i}^p\delta_{ij}x_{t-i}x_{t-j}+\sum_{i=1}^p\sum_{j=i}^p\sum_{k=j}^p\delta_{ijk}x_{t-i}x_{t-j}x_{t-k}+v_t$

与线性度假设现在是$H_0:\delta_{ij}=0,\delta_{ijk}=0$，对于所有的i，j和k。这与Lee等人讨论的NN检验（1993）有关，似乎有更好的效力。



11.44一旦发现了支持非线性的证据，Hsieh（1989）已经开发了一种可以揭示当前非线性类型的检验。更具体地说，该检验试图区分两种类型的非线性：“加法”和“乘法”。在前者中，非线性仅通过过程的条件均值进入：

$e_t=g(x_{t-1},...,x_{t-k},e_{t-1},...,e_{t-k})+u_t$

其中$g(\cdot)$是任意非线性函数。这表明双线性，阈值或平滑过渡模型可能比较合适。乘法非线性通过条件方差表现出来，因此指向ARCH类型模型：

$e_t=g(x_{t-1},...,x_{t-k},e_{t-1},...,e_{t-k})u_t$

该检验利用了以下事实：与加法依赖不同，乘法依赖意味着

$E(e_t|x_{t-1},...,x_{t-k},e_{t-1},...,e_{t-k})=0$(11.14)

假设$g(\cdot)$是至少两次连续可微的，则它可以通过零附近的泰勒展开式近似。该检验基于残差$u_t$必须与在乘法依赖下的扩展项不相关，该检验是通过估计数据的第三阶矩刻度来实现的：

$r_{eee}(i,j)=\frac{T^{-1}\sum e_te_{t-i}e_{t-j}}{(T^{-1}\sum e_t^2)^{1.5}}$

乘法非线性的零假设下，$T^{0.5}r_{eee}(i,j)$服从渐近正态分布，且方差可以一致估计为：

$\sigma^2=\frac{T^{-1}\sum e_t^2e_{t-i}^2e_{t-j}^2}{(T^{-1}\sum e_t^2)^{3}}$



11.45非线性检验也基于随机过程的可逆性。如果所有有限维分布对于时间索引的反转是不变的，一个平稳过程说是时间可逆的。换句话说，如果时间序列的概率结构相同，无论时间是向前还是向后，则序列是时间可逆的，否则，是不可逆的。i.i.d和平稳的高斯序列，例如ARMA过程，将是时间可逆的。但通常，非高斯过程在时间上是不可逆的。Ramsey和Rothman（1996）提出了TR检验统计量，估计各种k滞后为：

$TR(k)=\hat B_{2,1}(k)-hat B_{1,2}(k)$

其中$\hat B_{2,1}(k)$和$\hat B_{1,2}(k)$分别是双协方差$E(x_t^2x_{t-k})$和$E(x_tx_{t-k}^2)$的估计量。这些可以使用来自线性拟合的残差：

$\hat B_{i,j}(k)=(T-k)^{-1}\sum_{t=k+1}^Te_t^ie_{t-k}^j,i,j=1,2$

尽管ARCH过程是不可逆的，但TR检验反对他们没有效力，因为他们的双协方差为零。在时间可逆性零假设下，TR对于所有滞后的期望值为零。当过程为i.i.d时，TR渐近正态分布，具有方差

$V(TR(k))=2\frac{(\mu_4\mu_2-\mu_3)}{T-k}-2\frac{\mu_2^3(T-2k)}{(T-k)^2},\mu_i=E(e_t^i)$

如Rothman（1992）所示，收敛到渐近正态性足够快，即使过程是非i.i.d,且检验已应用到非正态误差线性拟合的残差。 Rothman证明该检验对于简单的双线性和SETAR模型具有合理的功效，并且可以在模型识别过程中利用检验的独特拒绝模式。



## **非线性模型的预测**

11.51通过非线性模型进行的一步预测非常简单，但是多步预测可能很复杂。如果我们有简单的非线性模型$x_t=g(x_{t-1})+\varepsilon_t$，然后一步提前预测并且简单由$f_{T,1}=g(x_t)$给定。但是，提前两步预测是

$f_{T,2}=E(x_{T+2}|x_T)=E(g(g(x_{T+1})+\varepsilon_{T+1}))=\int_\varepsilon g(g(x_{T+1})+\varepsilon_{T+1})dF(\varepsilon)$(11.15)

其中$dF(\varepsilon)$是$\varepsilon$的累积分布函数。(11.15)的数值积分可能会很困难，尤其是当预测范围增加。如果忽略误差项，可以使用Tong（1990）称之为“骨架”预测：$f_{T,h}=g(x_{T+h-1}|x_T)$。但是，这个预测将有偏差。或者，(11.15)的积分可以通过仿真或自助法近似拟合模型的残差。
