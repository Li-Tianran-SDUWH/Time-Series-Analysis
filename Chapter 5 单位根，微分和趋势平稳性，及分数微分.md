# **Chapter 5 单位根，差分和趋势平稳性，及分数差分**

## **确定一个时间序列的单积阶数**

5.1  单积阶数d是时间序列显示的属性的重要决定因素。如果我们限制设d为最常见的0和1，因此$x_t$为$I(0)$或$I(1)$，那么将这两个过程的属性组合在一起是很有用的。

如果$x_t$为$I(0)$，我们有时将其表示为$x_t\sim I(0)$,尽管以前已使用符号来表示分布特征，那么，为方便起见，假设$x_t$的均值为零；

1.  $x_t$的方差是有限的，不依赖于t；

2. 新息$a_t$对$x_t$的值只是暂时的影响；

3. x=0的两次穿越之间的预期时间长度是有限的，因此$x_t$在零均值附近波动；

4. 对于足够大的k，自相关，$\rho_k$，逐渐减小，因此它们的和是有限的。

另一方面，如果,$x_t\sim I(1)$，$x_0=0$,则；

1. 随着t趋于无穷，$x_t$的方差变为无穷大；

2. 新息$a_t$对$x_t$的值具有永久影响，因为$x_t$是以前所有新息的总和：$x_t=\bigtriangledown^{-1}a_t=Sa_t=\sum_{i=0}^{t-1}a_{t-i}$

3. x=0的两次穿越之间的预期时间是无限的；

4. 对于所有k,随着t趋向无穷大,自相关$\rho_k\to 1$。

   

5.2 时间序列是非平稳的，从序列的图中常常是不言而喻的。但是，只通过视觉检查要确定非平稳性的实际形式并不容易，因此可能需要检查序列的其他差分的SACF。

要了解为什么会这样，平稳的AR（p）过程要求

$\phi(B)=(1-g_1B)(1-g_2B)...(1-g_pB)$

的所有根$g_i$，必须有$|g_i|<1$。现在假设其中之一，例如$g_1$，接近1，因此$g_1=1-\delta$，其中$\delta$是一个很小的正数。自相关

$\rho_k=A_1g_1^k+A_2g_2^k+...+A_pg_p^k$

然后将由前置项$A_1g_1^k$主导，因为所有其他项都会迅速为零，即$\rho_k\cong A_1g_1^k$。此外，由于$g_1$接近1，所以指数衰减$A_1g_1^k$会很慢并且几乎是线性的，既然

$A_1g_1^k=A_1(1-\delta)^k=A_1(1-\delta k+\delta^2 k^2-...)\cong A_1(1-\delta k)$

因此，SACF无法快速消失的迹象表明非平稳性，其行为倾向于缓慢线性下降。如果发现原始序列$x_t$不平稳，则分析一阶差分$\bigtriangledown x_t$ 。如果$\bigtriangledown x_t$ 仍然是非平稳的，则分析二阶差分$\bigtriangledown ^2x_t$ ，重复该过程，直到找到稳定的差分，尽管实践中d不会超过2。



5.3完全依赖SACF有时会导致过度差分的问题。尽管平稳序列的进一步差分本身保持平稳，过度差分可能会导致严重的困难。考虑平稳的MA（1）过程$x_t=(1-\theta B)a_t$，这个的一阶差分是

$\bigtriangledown x_t=(1-B)(1-\theta B)a_t=(1-(1+\theta) B+\theta B^2)a_t=(1-\theta_1B-\theta_2B)a_t$ 

我们现在有一个更复杂的模型，其中包含两个参数而不止一个，而且，$\theta(B)$多项式的一个根将为1，既然$\theta_1+\theta_2=1$。模型，因此，不可逆的，因此$AR(\infty)$表示$\bigtriangledown x_t$不存在，并且尝试估计该模型几乎肯定会遇到困难。



## **单位根检验**

5.4鉴于选择正确的差分阶数的重要性，我们应该有正式的检验程序来确定d。在介绍开发此类程序所涉及的问题之前，我们首先考虑最简单的情况，零均值AR（1）过程：

$x_t=\phi x_{t-1}+a_t,t=1,2,...,T$

其中$a_t\sim WN(0,\sigma^2)$且$x_0=0$，$\phi$的OLS估计由下式给出

$\hat\phi_T=\frac{\sum_{t=1}^Tx_{t-1}x_t}{\sum_{t=1}^Tx_t^2}$

如我们所见，如果$|\phi|<1$，则$x_t$为$I(0)$,如果$\phi=1$，则$x_t$为$I(1)$,所以检验这个零假设（即“单位根”）成为确定差分/单积的正确阶数一种方法。给定估计$\hat\phi_T$，检验零假设的传统方式是构造t统计量

$t_{\phi}=\frac{\hat\phi_T-1}{\hat\sigma_{\hat\phi_T}}=\frac{\hat\phi_T-1}{(s_T^2/\sum_{t=1}^Tx_{t-1}^2)^{1/2}}$(5.2)

其中

$\hat\sigma_{\hat\phi_T}=(s_T^2/\sum_{t=1}^Tx_{t-1}^2)^{1/2}$

为$\hat\phi_T$的通常OLS标准误差，$s_T^2$是$\sigma^2$的OLS估计：

$s_T^2=\frac{\sum_{t=1}^T(x_t-\hat\phi_Tx_{t-1})^2}{T-1}$



5.5不幸的是，当$\phi=1$时，$t_{\phi}$的分布没有通常极限标准正态分布，相反，它的分布是如图5.1所示，在认识到其非正态的情况下称为τ分布。检验统计量(5.2)重命名为τ，而不是$t_{\phi}$，并且通常是已知的，正如Dickey‑Fuller检验一样，分布确实如此。

图5.1显示τ的极限分布近似为标准正态，但向左移动约0.3：大的T，5％，2.5％和1％，τ的临界值为 -1.95 、-2.23和-2.58，而不是标准正态的临界值为-1.65、-1.96和-2.33。

![](media/1.png)

图5.1τ的极限分布。

![](media/2.png)

图5.2 $\tau_{\mu}$的极限分布。



5.6此案的优点是简单，但并非特别现实，因为它暗示着无漂移随机游走的替代方案是零均值的平稳AR（1）过程，这将排除只取正值的序列，有很多这样的序列（大多数是经济和金融时间序列）。一个更明智的选择是使AR（1）过程围绕非零均值波动，因此我们有模型：

$x_t=\theta_0+\phi x_{t-1}+a_t,t=1,2,...,T$

在其中单位根零假设被参数化为$\theta_0=0,\phi=1$。截距的存在改变检验统计量的分布，现在表示$\tau_{\mu}$强调在回归(5.3)中允许非零均值。图5.2呈现$\tau_{\mu}$的分布。均值非零时，在单位根零假设下的分布，跟平均值为零比，与标准正态的偏离更多（与图5.1比较），且T分别为5％，2.5％和1％的临界值现在是-2.86、-3.1和-3.43。



5.7更一般的是允许对新息自相关。假设$x_t$由AR（p）过程生成：

$(1-\phi_1B-\phi_2B^2-...-\phi_pB^p)x_t=\theta_0+a_t$

或者

$x_t=\theta_0+\sum_{i=1}^p\phi_ix_{t-i}+a_t$(5.4)

通过定义下式，获得一个更方便的表示

$\phi=\sum_{i=1}^p\phi_i$

$\delta_i=-\sum_{j=i+1}^{p-1}\phi_j,i=1,2,...,p-1$

这样就可以用k=p-1来写(5.4)

$x_t=\theta_0+\phi x_{t-1}+\sum_{i=1}^k\delta_i\bigtriangledown x_{t-i}+a_t$(5.5)

从而单位根零假设，为$\phi=\sum_{i=1}^p\phi_i=1$。OLS提供（5.5）系数的一致估计，且检验$\phi=1$可以被构造为

$\tau_{\mu}=\frac{\hat\phi_T-1}{se(\hat\phi_T)}$

其中$se(\hat\phi_T)$是估计$\hat\phi_T$的OLS标准误差。该统计量也被表示$\tau_{\mu}$因为它具有相同分布，从AR（1）模型(5.3)获得的统计量，通常称为富勒（ADF）检验。按同样方式，(5.5)被称为ADF回归。



5.8对5.4‑5.7的分析隐含地假设AR阶p是已知的，因此我们可以确定是由p阶自回归生成$x_t$。如果生成的过程是一个ARMA（p，q），则统计量通过估计模型获得：

$x_t=\theta_0+\phi x_{t-1}+\sum_{i=1}^k\delta_i\bigtriangledown x_{t-i}+a_t-\sum_{j=1}^q\theta_ja_{t-j}$

与从(5.5)计算得出的极限分布相同。这里的问题是假设p和q已知，在实际情况中这不太可能。当p和q未知时，可以使用从(5.5)获得的检验统计量，如果k，$\bigtriangledown x_t$的滞后数，作为回归变量引入时，随着样本量T的增加而增加。通常，将k设置为$[T^{0.25}]$在实践中应该相当有效，其中$[\cdot]$表示取参数的整数部分：例如，对于  T=50 ，$[T^{0.25}]=2.659$，则k设置为2；对于T=500，$[T^{0.25}]=4.729$，因此，k=4。此调整是必要的，因为随着样本数增加，残差的相关结构对分布$\tau_{\mu}$的形状的影响变得更为精确。k的更准确设置可以通过使用例如信息准则或通过对滞后进行一系列t检验来确定，一旦选择了k合适的最大值，也许可以通过经验法则讨论。



## 趋势对差分平稳

5.9在前面概述的单元根检验策略中，隐式零假设是，该序列是作为无漂移随机游走而生成的，可能是自相关的新息。用流行的术语说，是差分平稳（DS），

$\bigtriangledown x_t=\varepsilon_t$(5.6)

其中$\varepsilon_t=\theta(B)a_t$，而另一种方法是使$x_t$在水平上平稳。尽管无漂移随机游走的零假设在许多时间序列上都很合适，其他通常包含漂移，因此相关的零假设变为

$\bigtriangledown x_t=\theta+\varepsilon_t$(5.7)

在这种情况下，可能的替代方案是由埋在平稳噪声中的线性趋势生成$x_t$，现称为趋势平稳（TS）：

$x_t=\beta_0+\beta_1 t+\varepsilon_t$(5.8)

不幸的是，从(5.5)获得的统计量是不能把线性趋势平稳过程[模型(5.8)]与具有单位根和漂移[模型(5.7)]的过程区分开来。确实，拒绝单位根原假设不可能使用这个统计量，如果序列线性趋势平稳，并且随着样本量的增加而变得不可能，即检验与Perron（1988）首次宣布的结果不一致。

![](media/3.png)

图5.3 $\tau_{\tau}$的极限分布



5.10 然而，针对(5.8)进行(5.7)的检验很容易通过使用前面讨论的检验方法扩展：通过将时间趋势t作为额外的回归项，可以简单地扩展ADF回归(5.5)，

$x_t=\beta_0+\beta_1t+\phi x_{t-1}+\sum_{i=1}^k\delta_i\bigtriangledown x_{t-i}+a_t$(5.9)

计算统计量

$\tau_{\tau}=\frac{\hat\phi_T-1}{se(\hat\phi_T)}$

这种“t-统计”被表示为$\tau_{\tau}$来区分它和$\tau_{\mu}$，因为它具有不同的极限分布，如图5.3所示。大T的5％，2.5％和1％临界值现在为-3.41、-3.66和-3.96，并且既然这些比$\tau_{\mu}$相匹配的值“更负”，拒绝DS零假设之前，需要从$\phi=1$开始有更大的偏差。



## **检验多个单元根**

5.11单位根检验的发展基于假设:$x_t$最多包含一个单位根，因此它是$I(0)$或$I(1)$。如果单位根的原假设不被拒绝，那么它可能有必要检验该序列是否包含第二个单位根，换句话说，$x_t$是否为$I(2)$，因此需要两次差分得到平稳性。



## **估计趋势稳健性**

5.17再次考虑线性趋势模型（5.8）：$x_T=\beta_0+\beta_1t+\varepsilon_t$。如我们已经看到，趋势的正确规格对于单位根和平稳检验很重要。正如5.9中指出的那样，错误地不含线性趋势使$\tau_{\mu}$统计量不一致，同时它也是不必要地包含趋势大大降低了$\tau_{\tau}$检验的效力的例子，类似的问题，影响KPSS平稳统计量$\eta_{\mu}$,$\eta_{\tau}$。

然而，通常的趋势参数$\beta_1$是直接影响，尤其是当确定一个趋势存在（$\beta_1\ne0$）或不存在（$\beta_1=0$）。这个可以通过构建无趋势零假设$\beta_1=0$的直接检验来评估或通过形成$\beta_1$的置信区间。这样的检验依赖$\varepsilon_t$，因此$x_t$，是$I(0)$或$I(1)$，但是这只能在执行单位根或平稳性检验后完成，但是后面这些检验的所有结果反过来又取决于趋势是否正确！这种推理的循环性促进了发展趋势函数检验程序稳健性，在这种意义上说，至少渐近地，趋势函数推论不受$\varepsilon_t$是$I(0)$或$I(1)$的影响。



5.18为了开发可靠的趋势检验，我们从最简单的情况开始，$\varepsilon_t=\rho\varepsilon_{t-1}+a_t$，如果$|\rho|<1$，则$\varepsilon_t$是$I(0)$，则是，如果$\rho=1$，则$\varepsilon_t$是$I(1)$。然后我们希望检验$H_0:\beta_1=\beta_1^0$，反对备择假设$H_0:\beta_1\ne\beta_1^0$。如果$\varepsilon_t$已知为$I(0)$，则对$H_0$的最佳检验由“斜率”t比率给出

$z_0=\frac{\hat \beta_1-\beta_1^0}{s_0},s_0=\sqrt{\frac{\hat\sigma_{\varepsilon}^2}{\sum_{t=1}^T(t-\hat t)^2}}$(5.12)

其中$\hat\sigma_{\varepsilon}^2=(T-2)^{-1}\sum_{t=1}^T(x_t-\hat\beta_0-\hat\beta_1t)^2$是（5.8）OLS估计的误差方差。在$H_0$下，$z_0$为渐近标准正态。

在另一方面，如果$\varepsilon_t$已知是$I(1)$，则对$H_0$最佳检验是基于(5.8)一阶差分形式的$\beta_1$的OLS估计的t比率，

$\triangledown x_t=\beta_1+v_t,t=2,...,T$(5.13)

其中$v_t=\triangledown \varepsilon_t$：

$z_1=\frac{\widetilde \beta_1-\beta_1^0}{s_0},s_0=\sqrt{\frac{\widetilde \sigma_{v}^2}{T-1}}$

这里

$\widetilde \beta_1=(T-1)\sum_{t=2}^T\triangledown x_t=(T_1)(x_T-x_1)$

是在(5.13)的$\beta_1$的OLS估计，且$\widetilde \sigma_{v}^2=(T-2)^{-1}\sum_{t=2}^T(\triangledown x_t-\widetilde \beta_1)^2$。同样，在$H_0$下，$z_1$将是渐近标准正态。



5.19如果不知道$\varepsilon_t$是$I(0)$或$I(1)$怎么办？Harvey, Leybourne,和Taylor (HLT, 2007)表明，$z_0$和$z_1$的加权平均值表示

$z_{\lambda}=(1-\lambda(U,S))z_0+\lambda(U,S)z_1$(5.14)

其中U是标准的单位根检验统计量，S是标准的趋势平稳检验统计量，且

$\lambda=exp(-\kappa(U/S)^2)$(5.15)

在$H_0$下将是渐近标准正态，因此提供了一个方便的趋势假设检验，无需假设误差生成过程模型。

$z_{\lambda}$的渐近标准正态使$\beta_1$的近似置信边界被构造，无论误差$I(0)$或$I(1)$都支持。如果$c_{\alpha/2}$是标准正态分布的$\alpha/2$分位数，例如，则$\beta_1$的近似$(1-\alpha)\%$双边置信区间由下式给出

$\hat\beta_{1,\lambda}\pm c_{\alpha/2}\frac{s_0s_1}{(1-\lambda(U,S))s_1+\lambda(U,S)s_0}$(5.16)

其中

$\hat\beta_{1,\lambda}=\frac{(1-\lambda(U,S))\hat\beta_1s_1+\lambda(U,S)\widetilde\beta_1s_0}{(1-\lambda(U,S))s_1+\lambda(U,S)s_0}$

$\hat\beta_{1,\lambda}$是$\beta_1$的一个一致的渐近有效估计，再次无论$\varepsilon_t$是$I(0)$或$I(1)$都成立。



5.20在典型的应用中，误差规范$\varepsilon_t=\rho\varepsilon_{t-1}+a_t$需要被扩展到包括额外的自相关，于是$\hat\sigma_{\varepsilon}^2$和$\widetilde\sigma_{\varepsilon}^2$可以通过它们对应的长期方差替代。



5.21 HLT建议使用U中的DF-GLS统计量和S的KPSS $\eta_{\tau}$统计量，且在设(5.15)设置常数κ=0.00025。在一个典型的有自相关的情况下，应该使用这些检验的增强版本。



5.22 HLT方法的优点是可以仅使用现成的统计量计算出来，但无法获得最佳性且其他检验可能具有更好的尺寸和功率属性。Bunzel和Vogelsang（2005），Perron和Yabu（2009）提出了二种替代方法。但后者似乎具有一些良好的统计属性，其结果趋势估计获得会更复杂。



## **分数差分和长记忆**

5.23到目前为止，我们的分析仅考虑了以下差分阶数，d为零，一或为二。专注前两种情况，如果$x_t\sim I(1)$则其ACF线性下降，而如果$x_t\sim I(0)$,ACF呈指数下降，因此相距甚远的观测值假设是独立的，或者至少接近独立。许多经验观测时间序列，尽管看起来似乎满足平稳（也许在差分之后），但似乎表现出一定的遥远的观测之间的依赖性，虽然很小，但绝不是可忽略的。这可以称为远程持久性或依赖性，尽管长记忆这个术语现在很流行。

这种序列特别是在水文学中发现的，河流流量的范围持续性被称为赫斯特效应（参见Mandelbrot和Wallis，1969年；Hosking，1984年），但很多金融时间序列还表现出非常长的持久性的类似特征。这可能被表征为大值的趋势，随后又进一步相同符号的大值，以使观测结果看起来像经历一系列的“循环”，包括长度与总样本量相当的长周期。



5.24 ARIMA一类的过程可以扩展为通过放宽对d的整数值的限制来对这种长期持久性类型建模，因此允许在AR类别的单积MA（ARFIMA）过程进行分数差分。分数差分/单积的概念似乎是由 Granger和Joyeux（1980），和Hosking（1981）提出的，并且考虑到二项式序列$\triangledown^d$展开，对于任何实数d\>-1：

$\triangledown^d=(1-B)^d=\sum_{k=0}^\infty \frac{d!}{(d-k)!k!}(-B)^k$(5.17)

通过这种扩展，我们可以将ARFIMA（0，d，0）过程定义为

$\triangledown^d x_t=(1-\pi_1B-\pi_2B^2-...)x_t=a_t$(5.18)

其中，使用伽马函数$\Gamma(n)=(n-1)!$，π权重为

$\pi_j=\frac{\Gamma(j-d)}{\Gamma(-d)\Gamma(j+1)}$

因此，此过程可以解释为无限自回归，并且可以通常称为分数白噪声。(5.18)取逆产生无限MA代表

$ x_t=\triangledown^{-d}a_t=(1-\psi_1B-\psi_2B^2-...)a_t$

其中

$\pi_j=\frac{\Gamma(j+d)}{\Gamma(d)\Gamma(j+1)}$

对于$-1<d<0.5$，自相关为

$\rho_k=\frac{\Gamma(1-d)}{\Gamma(d)}\frac{\Gamma(k+d)}{\Gamma(k+1-d)}\approx \frac{\Gamma(1-d)}{\Gamma(d)}k^{2d-1}=A(d)k^{2d-1}$(5.19)

其中大k的斯特林近似值，$\Gamma(k+a)/\Gamma(k+b)\approx k^{a-b}$，已被使用。自相关因此表现出双曲线衰减，即速度取决于d，并且在$\pi$和ψ权重中都可以看到这个性质。这种衰减是$k^{2d-1}$的函数，通常称为“幂律”衰减，并且将出现在所有显示长期范围持久的过程中，并且不仅限于ARFIMA过程（参阅Lieberman和Phillips，2008年）。

自相关的这种双曲线衰减的示例显示在图5.8，这些可以与ARMA模型的自相关进行对比，对于大K，是大约$A\theta^k,|\theta|<1$的形式（回想3.10）。它们以指数速率趋于零，因此比（5.19）给出的自相关的双曲线衰减下降更快。

![4](media/4.png)

图5.8  ARIMA（0，d，0）过程的ACF，d=0.30和d=0.45。



5.25从（5.19）可以明显看出，对于d\<0.5，过程（5.18）将是弱平稳的，对于d\>-0.5可逆。对于$d\ge0.5$,$x_t$的方差有限，因此该过程是非平稳的，但可以说比一个单位根过程（参阅Robinson，1994年）“更非平稳”，从而平滑地弥合了$I(0)$和$I(1)$过程之间的鸿沟。当d为正时才获得平稳的持续趋势行为和正依赖。d为负的过程其特征在于持久性的非平滑形式，通常称为反持久性，这与负短期和长期相关。

这些属性也由更通用的ARFIMA（p，d，q）过程显示，虽然$\pi$和ψ权重的参数表达式非常复杂：有关这些信息，参见Baillie（1996），以及Lieberman和Phillips（2008）和Phillips（2009）中有关长记忆过程的自协方差函数。



5.26如5.23所述，分数差分过程的长范围持续通常称为长记忆，这个概念背后的直观和整数d限制的局限性在时间序列的频域表示中更清晰地出现。

Wold分解（3.2）提供了平稳序列作为白噪声线性滤波器的时域表示，等效表示由其谱密度给出。Wold （1938）的定理5指出：存在平稳过程的必要和充分条件是自相关$\rho_k$成为一个非递减函数$F(\omega)$的系数，使得$F(0)=0,F(\pi)=\pi$，和

$\rho_k=(1/\pi)\int_0^{\pi}cosk\omega\cdot dF(\omega)$

可以求逆得到傅立叶变换

$F(\omega)=\omega+2\sum_{k=1}^{\infty}\frac{\rho_k}{k}sink\omega$

其也被称为$\rho_k$的生成函数。在3.7收敛条件意味着$F(\omega)$导数存在，为

$f(\omega)=\frac{df(\omega)}{d\omega}=\sum_{k=-\infty}^{\infty}\rho_k cosk\omega=1+2\sum_{k=1}^{\infty}\rho_k cosk\omega$(5.20)

$F(\omega)$被称为单积功率谱，$f(\omega)$作为谱线密度（或仅仅是频谱），ω被称为频率。定义$z=e^{-i\omega}$使（5.20）写出，使用三角函数欧拉方程恒等式，

$f(\omega)=\sum_{k=-\infty}^{\infty}\rho_k z^k$



5.27对于AR（1）过程$x_t=\phi x_{t-1}+a_t$，频谱由下式给出

$f(\omega)=1+2\sum_{k=1}^{\infty}\phi^kcosk\omega=\frac{\sigma_a^2}{2\pi}\frac{1-\phi^2}{1+\phi^2-2\phi cos\omega}$（5.21）

其中$\sigma^2$是白噪声新息$a_t$的方差。如果，通常在这种情况下，$\phi$为正，则在低频ω处频谱会很大，而在高频下较小，对于为负则相反：这些分别称为低频频谱和高频频谱。如果$\phi=0$获得白噪声频谱，这是简单地对于所有ω为常数$\sigma^2/2\pi$。

显然，如果$\phi=1$则（5.21）是不确定的，因此频谱不会存在一个单积过程。但是，如果$y_t=\triangledown^d x_t$，$x_t\sim I(d)$,则$y(t)\sim I(0)$将具有（5.20）形式的定义明确的频谱，表示为$f_y(\omega)$。尽管$x_t$并不严格拥有频谱，但可以认为具有“伪频谱”

$f_x(\omega)=|1-z|^{-2d}f_y(\omega)=(2sin|\omega/2|)^{-2d}f_y(\omega)$

使用结果$|1-z|^{-2d}=(2sin|\omega/2|)^{-2d}$。如果$y_t$有ARMA表示$\phi(B)y_t=\theta(B)a_t$，因为$y_t$平稳，其光谱$f_y(\omega)$的极限值，随着ω变小，必须是一个正的常数，比方说

$c=\frac{\sigma^2}{2\pi}(\frac{\theta(1)}{\phi(1)})>0$

对于ω小，它服从$2sin|\omega/2|\approx\omega$，$f_x(\omega)\propto c\omega^{-2d}$，如果d=1伪光谱采取形式$f_x(\omega)\propto c\omega^{-2}\to \infty$,当$\omega\to0$。但是如果d可以取非整数值，则低频时可能会有更广的谱，从而捕获长记忆行为。
