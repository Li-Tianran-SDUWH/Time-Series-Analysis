## **Chapter 1 时间序列及其特征**

1.2通常，某个变量$x$上的时间序列将表示为$x_t$，下标$t$代表时间，其中$t=1$是在$x$上的第一个观测值，且$t=T$是最后一个。完整的时间$t=1,2,...,T$通常被称为观测期。观测值的变动通常以相等的时间间隔进行测量，例如每分钟，小时或天等，因此观测到达的顺序至关重要。这不同于在给定时间点下获取的总体横截面数据，在这种情况下，数据的排序无关紧要，除非观测之间存在某种形式的空间依赖性。

1.3时间序列显示了多种特征，这些对于理解它们的性质和演化至关重要，包括计算未来的预测，即在时间$T+1,T+2,...,T+h$,$x_t$的未知值，其中$h$称为预测范围。



## **自相关和周期性运动**

1.4然而，这样的结论可能为时过早，因为索引中的内部相关性可能有助于识别有趣的周期性运动，并预测索引的未来值。这些通常指的是当前值$x_t$以及先前或滞后的值$x_{t-k},k=1,2,...$间的自相关。lag-k（样本）自相关定义为

$r_k=\frac{\sum_{t=k+1}^{T}(x_t-\bar{x})(x_{t-k}-\bar{x})}{Ts^2}$

其中

$\bar{x}=T^{-1}\sum_{t=1}^{T}x_t$

$s^2=T^{-1}\sum_{t=1}^{T}(x_t-\bar{x})^2$

分别是$x_t$的样本均值和方差。对k的各种值的样本自相关集合称为样本自相关函数（SACF），在时间序列分析中发挥关键作用。



## **季节性**

```python
#观测间隔为每季度
a = []
for i in range(2000,2016):
    for j in [1,4,7,10]:
        date = str(str(i)+'/'+str(j))
        a.append(date )

#数据来源：国家统计局
#http://data.stats.gov.cn/index.htm
df = pd.read_csv("啤酒销量.csv")

df['time'] = np.array(a)
df['time'] = pd.to_datetime(df['time'])
df.set_index('time', inplace=True)
#通过啤酒销售量累计值(万千升)，计算每季度销量
b = []
for i in range(len(df['sale'])):
    if i%4 == 0:
        b.append( df['sale'][i])
    if i%4 != 0:
        b.append( df['sale'][i] - df['sale'][i-1])
df['sale'] = b
print(df)
plt.plot(df['sale'])
plt.show()
```

![啤酒销售量](.\media\啤酒销售量.png)

图1.4中国啤酒销售量(万千升)：每季度，2000年至2015年。数据来自国家统计局。

1.7当每月或每季度观测一次时间序列时，年度季节模式通常是一个重要特征。图1.4显示了2000年至2015年间中国啤酒的销售量有多年来演变的季节性模式：第三季度销售额总是最高的，第一季度的销售额通常（但并非总是）最低，而第二和第四季度销售的相对规模似乎在观测期内波动。



## 平稳与非平稳

1.8 恒定的平均水平是平稳的一个（但不是唯一的）条件。图1.4中的啤酒销售量在整个观测期内均呈上升趋势。显然，啤酒的销量并没有在恒定的平均水平波动。

```python
#数据来源：英为财情
#https://cn.investing.com/currencies/usd-cny
df = pd.read_csv("汇率.csv")
df['time'] = pd.to_datetime(df['time'])
df.set_index('time', inplace=True)

plt.plot(df['rate'])
plt.show()
```

![汇率](media/汇率.png)

图1.5美元对人民币汇率：每日观测，1981年1月至2019年11月。数据来自英为财情。

1.9称一个序列是非平稳的，如果平均水平不能被认为是恒定的。但是，非平稳性可能以多种形式出现。图1.5 绘制了美元兑人民币从1981年到2019年的每日观测结果，汇率波动很大。双重汇率制于1981年正式实施，期初，人民币官方牌价—1.5元人民币/美元—远高于贸易内部结算价。内部结算价固定不变，而官方牌价却随着供求状况和通胀水平不断调整。较低的官方牌价导致供不应求，再加上较高的通胀，人民币不断贬值，外汇不断升值。从 1994 年 1 月 1 日起, 人民币官方汇率与外汇调剂市场汇率并轨 , 实行以市场供求为基础的、 单一的、有管理的浮动汇率制。 取消以前官方汇率与调剂汇率并存的制度。在 1997 年的东亚金融危机的冲击下，我国为稳定货币不贬值，在多重压力下, 最终选定了汇率不贬值 , 并逐渐演变为事实上的钉住美元的汇率制度。

2005 年 7 月 21 日, 中国人民银行发布《关于完善人民币汇率形成机制改革的公告》 , 宣布自公告起我国开始实行以市场供求为基础、参考一篮子货币进行调节、有管理的浮动汇率制度，美元对人民币汇率大幅下降。随着 2008 年金融危机的爆发和蔓延 , 现钞和现汇的买卖价开始保持稳定。 进入 2008 年以来 , 人民币汇率升值速度在加快 , 波动幅度在增大 , 弹性在增加 , 这似乎预示着汇率制度可能要发生某种突变。2010 年 6 月 19 日, 中国人民银行为提高货币政策的有效性，人民币重启对美元的持续升值，但汇率仍保持在 2%的爬行区间内。因此，央行宣布重启汇率改革， IMF 重新将我国汇率制度调整为类似爬行制度。到 2016 年，人民币开始贬值，现钞和现汇的买卖价也相应开始上升。

显然，假设汇率的平均水平不变无论从统计角度还是从经济角度来看都不适当。因此，汇率表现出一种非平稳性，可以称为随机游动或单位根非平稳性。

## **趋势**

1.10显然，汇率在整个观测期内并没有显示总体趋势，这被非正式地认为是通常单调向上或向下运动，这将在此处暗示该货币永久升值或贬值。

在许多时间序列中都可以找到趋势。但是，许多趋势没有恒定的斜率，因此不是线性的。确定时间序列是否包含趋势可能会非常困难。

## 波动

1.14平稳性的第二个条件是有恒定方差。图1.9显示了美元对人民币汇率的每日百分比变化。整个过程变化的特点是相对平静的时间点缀着爆发波动性，从而该序列的方差连续变化。因此，尽管汇率的每日百分比变化肯定会围绕一个恒定且几乎为零的平均值波动，但仍是非平稳的，因为方差不能视为常数。

```python
#数据来源：英为财情
#https://cn.investing.com/currencies/usd-cny
df = pd.read_csv("汇率变化.csv")
df['time'] = pd.to_datetime(df['time'])
df.set_index('time', inplace=True)

plt.plot(df['exchange'])
plt.show()
```

![汇率变化](media/汇率变化.png)

图1.9美元对人民币汇率的每日变化：2000年9月至2019年11月。数据来自英为财情。



## **共同特征**

1.15两个或更多时间序列可能包含共同特征。



## **具有自然约束的时间序列**

1.16一些时间序列具有自然的约束。

1.17到目前为止引入的所有时间序列都可以视为是以连续的规模，或者至少可以假定是良好的近似为连续的。但是，某些序列自然为整数，通常称为计数。

1.18分别了解时间序列显示的特征并分组进行，是成功进行分析的关键一步，显然可以通过数据的初始图了解。这样的图可能也暗示数据可能的变换，可能会加快形式分析和时间序列建模。

